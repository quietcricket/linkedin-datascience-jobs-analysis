package main

import (
	"regexp"
	"testing"
)

func TestExtractJson(t *testing.T) {
	body := `    <script type="application/ld+json">
	 {"@context":"http://schema.org","@type":"JobPosting","datePosted":"2022-05-24T01:45:05.000Z","description":"&lt;strong&gt;&lt;u&gt;About Us Data &amp;amp; Analytics At Dyson&lt;br&gt;&lt;br&gt;&lt;/u&gt;&lt;/strong&gt;Data and analytics excellence at Dyson are delivered by a diverse and collaborative global community spread across Dyson locations from Bristol to Chicago, Malmesbury to Singapore. Domain-specific experts form spoke analytics teams, enabled by a central team at the hub. All teams benefit from significant recent investments in cloud technologies and tools, combined with an expansive scope and no shortage of ambition and momentum; data and analytics are recognised throughout the organisation, to the highest level, as critical to all of Dyson’s strategic objectives.&lt;br&gt;&lt;br&gt;With a ‘one-team’ approach, the global community are on a mission to…&lt;br&gt;&lt;ul&gt;&lt;li&gt; …evolve existing solutions to stay ahead&lt;/li&gt;&lt;li&gt; …embed emerging solutions to capitalise on potential benefits&lt;/li&gt;&lt;li&gt; …deliver conceptualised &amp;amp; future solutions to introduce net-new capability&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;strong&gt;Our Data Team&lt;br&gt;&lt;br&gt;&lt;/strong&gt;As the ‘hub’ team delivering the data, technology and community provision enabling Dyson’s global data and analytics capabilities, Global Data Function (GDF) have end-to-end responsibility for data from foundations (DQ, MDM) to management (data platforms, integrations), to value realisation (analytics enablement and delivery).&lt;br&gt;&lt;br&gt;The team is a multi-disciplinary, global team providing round-the-clock development and operations - including product and project management, community enablement, governance, data architecture, data engineering, data science, and analytics expertise.&lt;br&gt;&lt;br&gt;Involved with every aspect of Dyson’s global business - from finance to product development, manufacturing to owner experience - data is enjoying record-breaking investment and mandate for 2021 and beyond, seeking to deliver solutions generating impressive and tangible business value.&lt;br&gt;&lt;br&gt;&lt;strong&gt;&lt;u&gt;About The Role&lt;br&gt;&lt;/u&gt;&lt;/strong&gt;&lt;ul&gt;&lt;li&gt;You will be a Data Scientist based in Singapore, working as part of the Data Science Centre of Excellence.&lt;/li&gt;&lt;li&gt;The Centre of Excellence is now taking shape; it is an incredible opportunity to take part in shaping the future of data science at Dyson, learning from Senior Data Scientists in the team, and enabling our analytics community by landing exciting use cases that drive real business value.&lt;/li&gt;&lt;li&gt;You will have hands-on experience with leveraging data from a wide selection of data sources through different technologies e.g. SQL, BigQuery etc., and a keen understanding of data models and ETL/ELT processes. Using primarily Python and supplementing this with Tableau or Looker where necessary, you are able to analyse, model, and visualise data effectively. Ideally you will have an MSc or PhD in a relevant field (e.g. Statistics, Mathematics) or similar hands-on experience.&lt;/li&gt;&lt;li&gt;You will help respond to complex business questions beyond what business intelligence teams are capable of today.&lt;/li&gt;&lt;li&gt;You will build predictive models using myriad data sources available at Dyson, and enriching these with the creative sourcing of external data.&lt;/li&gt;&lt;li&gt;You will apply logical thinking and statistical learning techniques to obtain robust results the business can rely on for critical decisions.&lt;/li&gt;&lt;li&gt;You will engage with the business and data product managers to shape and refine their questions.&lt;/li&gt;&lt;li&gt;You will team up with Data Engineers and Data Product Managers to get advice and support on accessing data.&lt;/li&gt;&lt;li&gt;Cutting edge approaches are key to keeping pace with Dyson’s innovative culture. You will be expected to stay abreast of industry trends and emerging technologies and methodologies.&lt;/li&gt;&lt;/ul&gt; &lt;strong&gt;About you&lt;br&gt;&lt;br&gt;&lt;/strong&gt;&lt;strong&gt;&lt;u&gt;Person Specification / Core Competencies&lt;br&gt;&lt;/u&gt;&lt;/strong&gt;&lt;ul&gt;&lt;li&gt;A degree in Statistics/ML/Business Analytics or a science/engineering degree with a keen interest in statistics.&lt;/li&gt;&lt;li&gt;Python skills with a focus on statistical and ML packages; Scikit-Learn, XGBoost, NumPy, SciPy, Tensorflow, Keras, PyTorch.&lt;/li&gt;&lt;li&gt;Experience in data cleansing and blending (internally and externally) to drive richer insights.&lt;/li&gt;&lt;li&gt;Scientific approach to solve practical problems, logical thinking. Advanced data modelling skills.&lt;/li&gt;&lt;li&gt;Basic knowledge on how to build data science products in cloud environments. Comfortable querying modern cloud databases (e.g. BigQuery, Snowflake, Redshift).&lt;/li&gt;&lt;li&gt;Passion to understand the business, frame problems, and deliver practical solutions on short time frames.&lt;/li&gt;&lt;li&gt;Self-driven individual with drive to solve customer problems. Team player and good communicator within the team and beyond, capable of building great stories our of sparse data&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;strong&gt;&lt;u&gt;Desirable&lt;br&gt;&lt;/u&gt;&lt;/strong&gt;&lt;ul&gt;&lt;li&gt;PhDs are valued, but innovation and excellence is essential.&lt;/li&gt;&lt;li&gt;Ability to interact and collaborate with data engineers and product manager&lt;/li&gt;&lt;li&gt;Docker and Kubernetes experience&lt;/li&gt;&lt;li&gt;Successful use of software engineering best practices, including version control (Git, Mercurial), unit testing and working with Agile delivery principles.&lt;/li&gt;&lt;li&gt;Exposure to MLOps practices and thinking.&lt;/li&gt;&lt;/ul&gt; &lt;strong&gt;Benefits&lt;br&gt;&lt;br&gt;&lt;/strong&gt;Dyson monitors the market to ensure competitive salaries and pension contributions. Beyond that, you’ll also enjoy a profit-related bonus, generous leave and life insurance. But financial benefits are only the start of a Dyson career. Rapid professional growth, leadership development and new opportunities abound, driven by regular reviews and dynamic workshops. And with a vibrant culture, flexible working hours, the latest devices and a relaxed dress code reflecting our engineering spirit, it’s an exciting team environment geared to creativity, innovation and ambition.&lt;br&gt;&lt;br&gt;Dyson is an equal opportunity employer. We know that great minds don’t think alike, and it takes all kinds of minds to make our technology so unique. We welcome applications from all backgrounds and employment decisions are made without regard to race, colour, religion, national or ethnic origin, sex, sexual orientation, gender identity or expression, age, disability, protected veteran status or other any other dimension of diversity.&lt;br&gt;&lt;br&gt;","employmentType":"FULL_TIME","hiringOrganization":{"@type":"Organization","name":"Dyson","sameAs":"https://sg.linkedin.com/company/dyson","logo":"https://media-exp2.licdn.com/dms/image/C560BAQEWPg-YOK9CVw/company-logo_200_200/0/1519856272097?e=1663804800&amp;v=beta&amp;t=jqy22YggJJ6guI3qEpq_CKv8yIyZR54bCTDYT-3HDB0"},"identifier":{"@type":"PropertyValue","name":"Dyson","value":"JR3204"},"image":"https://media-exp2.licdn.com/dms/image/C560BAQEWPg-YOK9CVw/company-logo_100_100/0/1519856272097?e=1663804800&amp;v=beta&amp;t=TuhKaD-vCSwhkkdG92m8U2R0sFIVPi3bBcg0FZgFe6k","industry":"Household Appliance Manufacturing","jobLocation":{"@type":"Place","address":{"@type":"PostalAddress","addressCountry":"SG","addressLocality":"Singapore","addressRegion":null,"streetAddress":null},"latitude":1.2894365,"longitude":103.84998},"skills":"","title":"Data Scientist","validThrough":"2022-06-23T01:45:05.000Z","educationRequirements":{"@type":"EducationalOccupationalCredential","credentialCategory":"bachelor degree"}} </script>
	hello 
	 </script>
	 `

	reg := regexp.MustCompile(`(?s)<script type=\"application/ld\+json\">([^<]+)?`)
	b := reg.FindStringSubmatch(body)
	t.Fatalf(b[1])
}

func TestLogMap(t *testing.T) {
	path := "./data/detail-scraper.log"
	log := OpenLog(path)
	for k := range log.Records {
		t.Log(k)
	}
}
